<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mypage</title>
    <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
    crossorigin="anonymous"
  />
    <link rel="stylesheet" href="mobile/css/common.css">
    <link rel="stylesheet" href="mobile/css/mypage/edit-info.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
</head>
<body>
    <!-- 모바일 컨테이너 -->
    <div id="mobile-container">
        <!-- 헤더 -->
        <header></header>
         <!-- 컨텐츠 컨테이너 -->
        <div id="container">
            <div id="editinfo-wrapper">
      			<div class="text-container">
	        		<div class="text" id="text-name">이름</div>
					<div class="text-invalid" id="invalid-name-check-fail">한글만 작성 가능합니다.</div>
				</div> 
				<input id="name">
                <div class="edit-content-wrapper">
                    <span id="text-id">아이디</span>
                    <span class="non-edit" id="id">bakbakkim</span>
                </div>
       			<div class="text-container">
        		<div class="text" id="text-nickname">닉네임</div>
            	<div class="text-invalid" id="invalid-nickname">사용 가능한 닉네임 입니다.</div>
				<div class="text-invalid" id="invalid-nickname-doub">중복된 닉네임 입니다.</div>
        		</div>
        		<input id="nickname">
                <div class="edit-content-wrapper">
                    <span id="text-birth">생년월일</span>
                    <span class="non-edit" id="birth">2001.06.30</span>
                </div>
				<div class="text-container">
					<div class="text" id="text-email">이메일</div>
					<div class="text-invalid" id="invalid-email">사용할 수 없는 이메일입니다.</div>
				</div>
				<input id="email">
		        <div class="text" id="text-phone">전화번호</div>
				<input id="phone" type="text" oninput="hypenTel(this)" maxlength="13">
                <div id="btn-wrapper">
                    <div>
                        <button id="edit-pw-btn" class="btn">비밀번호 수정</button>
                        <button id="withdraw-btn" class="btn"
                        data-bs-toggle="modal"
                        data-bs-target="#withdrawModal-1">회원 탈퇴</button>
                    </div>
                    <button id="my-info-edit-btn" class="btn">수정하기</button>
                </div>
            </div>
        </div>
        <!-- 하단 메뉴바 -->
         <nav></nav>
    </div>


    <!-- 부트스트랩 -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>

    <!-- 탈퇴 모달 1 -->
    <div class="modal" id="withdrawModal-1">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <!-- Modal Header -->
            <div class="modal-header">
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
              ></button>
            </div>
  
            <!-- Modal body -->
            <div class="modal-body">
              <div class="modal-body-wrapper">
                <h4 class="modal-title">정말로 탈퇴하시겠습니까?</h4>
                <span>탈퇴 시 정보가 모두 삭제되어 <br/>더 이상 확인할 수 없습니다. </span>
              </div>
            </div>
  
            <!-- Modal footer -->
            <div class="modal-footer">
              <button
                type="button"
                class="btn"
                id="withdrawModal-btn"
                data-bs-toggle="modal"
                data-bs-dismiss="modal"
                data-bs-target="#withdrawModal-3"
              >
                탈퇴하기
              </button>
            </div>
          </div>
        </div>
      </div>

    <!-- 탈퇴 불가 모달 -->
    <div class="modal" id="withdrawModal-2">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <!-- Modal Header -->
            <div class="modal-header">
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
              ></button>
            </div>
  
            <!-- Modal body -->
            <div class="modal-body">
              <div class="modal-body-wrapper">
                <span>매칭이 잡혀있거나, 팀에 소속되어 있을 경우 회원 탈퇴가 불가능합니다.</span>
                <span>위 사항을 모두 확인하신 후 다시 시도하시기 바랍니다.</span>
              </div>
            </div>
            <div class="modal-footer">
            </div>
          </div>
        </div>
      </div>

          <!-- 탈퇴 완료 모달 -->
    <div class="modal" id="withdrawModal-3">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <!-- Modal Header -->
            <div class="modal-header">
            </div>
  
            <!-- Modal body -->
            <div class="modal-body">
              <div class="modal-body-wrapper">
                <span>탈퇴 완료되었습니다. </span>
              </div>
            </div>
            <div class="modal-footer">
				<button
    	            type="button"
					class="btn"
					id="withdrawConfirm-btn">
					확인
				</button>
			</div>
            <div class="modal-footer">
              </div>
          </div>
        </div>
      </div>
  

    
    <script>
    // header, nav 내용 불러오기
    $(document).ready(function(){
        $('header').load('common/header_mypage_back.html', function(){
            $('#page-name').text('내 정보 수정');
        });
        $('nav').load('common/nav.html');
    });
	const getNameCheck = RegExp(/^[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]+$/);
	const getIdCheck = RegExp(/^[a-zA-Z0-9]{0,}$/);
    const specialCheck = RegExp(/[`~!@#$%^&*|\\\'\";:\/?]/);
	//이름 유효성 검사
	$("#name").keyup(function(){
		if($("#name").val() !=""){
			if(!getNameCheck.test($("#name").val())){
				$("#text-name").css("margin-right","4.5rem");
				$("#invalid-name-check-fail").css("display", "block");
				}
			else {
			$("#text-name").css("margin-right","14rem");
			$("#invalid-name-check-fail").css("display","none");
			}
		}
		else {
			$("#text-name").css("margin-right","14rem");
			$("#invalid-name-check-fail").css("display","none");
		}	
	})

	//닉네임 중복 검사
	$("#nickname").on("change",function(){
			const nickname = $("#nickname").val();
			$.ajax({
				type: 'post',
				url: "/user/getUserNickname",
				data: {"nickname":nickname},
				dataType: 'text',
				success: function(response){					
				if(nickname != ""){
					console.log(response);
					if(response === "true"){
						$("#text-nickname").css("margin-right","3rem");
						$("#invalid-nickname").css("display", "block");
						$("#invalid-nickname-doub").css("display", "none");
					}
					else{
						$("#text-nickname").css("margin-right","5rem");
						$("#invalid-nickname").css("display", "none");
						$("#invalid-nickname-doub").css("display", "block");
					}
				}
				else{
					$("#text-nickname").css("margin-right","13.5rem");
					$("#invalid-nickname").css("display", "none");
					$("#invalid-nickname-doub").css("display", "none");
				}},
				error: function(error){
					alert("오류" + error);
			}
		})
	})
	
	//전화번호 자동 형식
        const hypenTel = (target) => {
			target.value = target.value
   			.replace(/[^0-9]/g, '')
   			.replace(/^(\d{2,3})(\d{3,4})(\d{4})$/, `$1-$2-$3`);
		}
	
    </script>
    <script src="mobile/js/mypage.js"></script>
</body>
</html>